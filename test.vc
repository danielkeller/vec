*:(@{int}<*> in) printarr; 
*:(@{int}<*>, int b, int e) qsort;

type testt = (int x, int);

:((int x, int) i) bar =
{
	i(x) = i(x) + 1;
};

:(testt i) bar =
{
	i(x) = i(x) + 1;
};

cexp:int:() main =
{
	{int}<*> foo = {3,7,2,8,1,6,2,3,8};
	int in = 6;
	testt t = (in, 0);
	bar:(t);
	bar:((in, 0));
	printarr:(foo);
	qsort:(foo, 0, foo(length) - 1);
	printarr:(foo);
	return 0;
};

cexp:int:(int) putchar;
*:(@{int}<*> in) printarr = 
{
	int i = 0;
	while (i < in(length))
	{
		putchar:(in{i} + 48);
		putchar:(32);
		i = i + 1;
	}
	putchar:(10);
};

int:(@{int}<*> l, int b, int e, int p) partition =
{
	int pv = l{p};
	int tmp = l{e};
	l{e} = l{p};
	l{p} = tmp;
	int st = b;
	int i = b;
	while (i < e)
	{
		if (l{i} < pv)
		{
			tmp = l{i};
			l{i} = l{st};
			l{st} = tmp;
			st = st + 1;
		}
		i = i + 1;
	}
	tmp = l{e};
	l{e} = l{st};
	l{st} = tmp;
	return st;
};

*:(@{int}<*> l, int b, int e) qsort = 
{
	if (b >= e)
		return;
	printarr:(l);
	int pv = (b+e)/2;
	pv = partition:(l, b, e, pv);
	qsort:(l, b, pv-1);
	qsort:(l, pv+1, e);
};
